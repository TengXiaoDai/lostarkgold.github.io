var Airwallex=function(e){"use strict";const t={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",qa:"checkoutui.qa.awx.im",preview:"checkoutui.preview.awx.im",dev:"localhost:3000"},n={prod:"https://pci-api.airwallex.com",demo:"https://pci-api-demo.airwallex.com",staging:"https://pci-api-staging.airwallex.com",qa:"https://pci-api-qa.airwallex.com",preview:"https://pci-api-preview.airwallex.com",dev:"http://localhost:8080"};class i{constructor(e,t){var n,i;this.domElement=null,this.gatewayUrl=e,this.options=t,this.iframe=window.document.createElement("iframe"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","true"),this.iframe.setAttribute("importance","high"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("allowpaymentrequest","true"),null===(n=this.iframe)||void 0===n||n.setAttribute("style","\n        height: 0;\n        width: 100%;\n        display: block;\n      "),i=e=>{var t,n,i;if(e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)){const t=new CustomEvent(null===(n=e.data)||void 0===n?void 0:n.code,{detail:{type:null===(i=e.data)||void 0===i?void 0:i.type},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}},window.addEventListener("message",(e=>{window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(e.data)),i(e)}))}addResizeListener(e){window.addEventListener("message",(t=>{var n,i,o,l;if(t.origin===this.gatewayUrl&&t.isTrusted&&"onResize"===(null===(n=t.data)||void 0===n?void 0:n.code)&&e===(null===(i=t.data)||void 0===i?void 0:i.type)){const e=null===(o=this.iframe)||void 0===o?void 0:o.style;e&&(e.height=`${null===(l=t.data)||void 0===l?void 0:l.height}px`)}}))}mount(e){if("string"!=typeof e)return(null==e?void 0:e.hasChildNodes())&&(e.innerHTML=""),this.iframe&&e.appendChild(this.iframe),this.domElement=e,e;{const t=window.document.getElementById(e);return(null==t?void 0:t.hasChildNodes())&&(t.innerHTML=""),this.iframe&&(null==t||t.appendChild(this.iframe)),t&&(this.domElement=t),t}}blur(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"blur"},this.gatewayUrl)}clear(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"clear"},this.gatewayUrl)}destroy(){var e;this.clear(),null===(e=this.iframe)||void 0===e||e.remove(),this.iframe=null}focus(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"focus"},this.gatewayUrl)}unmount(){var e;this.clear(),this.iframe&&(null===(e=this.domElement)||void 0===e||e.removeChild(this.iframe))}update(e){var t,n;this.options={...this.options,...e},null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"update",options:e},this.gatewayUrl)}async confirm(){throw new Error("Confirm is not supported in ElementBase")}success(e){throw new Error(`Call success with ${e.id} is not supported in ElementBase`)}fail(e){throw new Error(`Call fail with ${e.code}: ${e.message} is not supported in ElementBase`)}}class o extends i{constructor(e,t,n){var i,o,l,d;super(e,n),this.confirmResponse=t,null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/elements/3ds-frictionless?options=${encodeURIComponent(JSON.stringify(this.options))}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex 3DS frictionless iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex 3DS frictionless iframe"),window.addEventListener("message",(e=>{var t,n,i,o;e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsFrictionless"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:this.confirmResponse},this.gatewayUrl))}))}async confirm(){var e,t;return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),null}}class l extends i{constructor(e,t,n){var i,o,l,d,a,s,r,c,u;super(e,n),this.confirmResponse=t;const v=(null==n?void 0:n.customizeChallengeWindowSize)&&$[null==n?void 0:n.customizeChallengeWindowSize]?$[null==n?void 0:n.customizeChallengeWindowSize]:$["05"],m=(null===(i=null==n?void 0:n.style)||void 0===i?void 0:i.popupWidth)?`${null===(o=null==n?void 0:n.style)||void 0===o?void 0:o.popupWidth}px`:v[0],p=(null===(l=null==n?void 0:n.style)||void 0===l?void 0:l.popupHeight)?`${null===(d=null==n?void 0:n.style)||void 0===d?void 0:d.popupHeight}px`:v[1];null===(a=this.iframe)||void 0===a||a.setAttribute("src",`${e}/#/elements/3ds-challenge?options=${encodeURIComponent(JSON.stringify(this.options))}`),null===(s=this.iframe)||void 0===s||s.setAttribute("name","Airwallex 3DS challenge iframe"),null===(r=this.iframe)||void 0===r||r.setAttribute("title","Airwallex 3DS challenge iframe"),null===(c=this.iframe)||void 0===c||c.setAttribute("scrolling","yes"),null===(u=this.iframe)||void 0===u||u.setAttribute("style",`\n        background: #fff;\n        width: ${m};\n        height: ${p};\n        position: ${(null==n?void 0:n.useDefaultStyle)?"absolute":"relative"};\n        top: ${(null==n?void 0:n.useDefaultStyle)?"50%":"0"};\n        left: ${(null==n?void 0:n.useDefaultStyle)?"50%":"0"};\n        transform: ${(null==n?void 0:n.useDefaultStyle)?"translate(-50%, -50%)":"none"};\n        border-radius: ${(null==n?void 0:n.useDefaultStyle)?"4px":"0"};\n      `),window.addEventListener("message",(e=>{var t,n,i,o;e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsChallenge"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:this.confirmResponse},this.gatewayUrl))}))}async confirm(){var e,t;return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),null}}const d="threeDsFrictionless",a="threeDsChallenge";let s,r,c,u,v,m,p,h;const w={resolver:null,reject:null,awaiting:!1},f=e=>{var t;null===(t=document.querySelector(`#${e}`))||void 0===t||t.remove(),ie(e===d?d:a)},g=()=>{w.awaiting=!1,w.resolver=null,w.reject=null},y=({intent:e,gatewayUrl:t,cardBin:n,next_action:i,authFormContainer:l,componentType:a,challengeWindowSize:s})=>{var u;w.awaiting&&console.warn("Should wait previous 3ds flow finished before execute new one!"),console.log("threeDsHandler onChallenge type",(new Date).toLocaleTimeString()),r=document.getElementById(l||""),c=a,m=s,p=t,h=e,f(d),le(d,new o(p,{code:"",type:d,cardBin:n,next_action:i},{intent:h,origin:window.location.origin}));const v=document.createElement("div");return v.setAttribute("id",d),document.body.appendChild(v),window.addEventListener("message",b),null===(u=oe(d))||void 0===u||u.mount(v),new Promise(((e,t)=>{w.resolver=e,w.reject=t,w.awaiting=!0}))},b=e=>{var t,n,i;const o="data"in e?e.data:e.detail,y=["hpp","api"].includes(c),b=y?null:oe(c),C=(null==b?void 0:b.gatewayUrl)||window.location.origin;("data"in e&&e.origin===C&&e.isTrusted||y)&&(null==o?void 0:o.type)===d&&(f(a),"onSuccess"===(null==o?void 0:o.code)&&(console.log("frictionlessHandler onSuccess",(new Date).toLocaleTimeString()),null===(t=w.resolver)||void 0===t||t.call(w,o),g(),f(d)),["onError","onChallengeError"].includes(null==o?void 0:o.code)&&(console.log(`frictionlessHandler ${null==o?void 0:o.code}`,(new Date).toLocaleTimeString()),null===(n=w.reject)||void 0===n||n.call(w,o),g(),f(d)),"onChallenge"===(null==o?void 0:o.code)&&(console.log("frictionlessHandler onChallenge threeDsFrictionlessType",(new Date).toLocaleTimeString()),f(d),r?s=r:(s=document.createElement("div"),s.setAttribute("id",a),s.setAttribute("style","\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 0;\n            z-index: 1500;\n            overflow: hidden;\n            background: rgba(0, 0, 0, 0.75);\n          "),document.body.appendChild(s)),le(a,new l(p,o,{origin:window.location.origin,style:{popupWidth:u,popupHeight:v},useDefaultStyle:null===r,customizeChallengeWindowSize:m,intent:h})),window.addEventListener("message",E),null===(i=oe(a))||void 0===i||i.mount(s)))},E=e=>{var t,n;const i="data"in e?e.data:e.detail,o=["hpp","api"].includes(c),l=o?null:oe(c),d=(null==l?void 0:l.gatewayUrl)||window.location.origin;("data"in e&&e.origin===d&&e.isTrusted||o)&&(null==i?void 0:i.type)===a&&("onReady"===(null==i?void 0:i.code)&&(console.log("challengeHandler onReady",(new Date).toLocaleTimeString()),setTimeout((()=>{s.style.height="100%"}),2e3)),"onChallengeSuccess"===(null==i?void 0:i.code)&&(s.style.height="0"),"onSuccess"===(null==i?void 0:i.code)&&(console.log("challengeHandler onSuccess",(new Date).toLocaleTimeString()),null===(t=w.resolver)||void 0===t||t.call(w,i),g(),f(a)),["onError","onChallengeError"].includes(null==i?void 0:i.code)&&(console.log(`challengeHandler ${null==i?void 0:i.code}`,(new Date).toLocaleTimeString()),null===(n=w.reject)||void 0===n||n.call(w,i),g(),f(a)))},C=({type:e,popupWidth:t,popupHeight:n,authFormContainer:i})=>{u=t,v=n;const o=async t=>{var n,l,d,a;const s="data"in t?t.data:t.detail,r="hpp"===e,c=r?null:oe(e),u=(null==c?void 0:c.gatewayUrl)||window.location.origin;if(("data"in t&&t.origin===u&&t.isTrusted||r)&&(null==s?void 0:s.type)===e&&"onChallenge"===(null==s?void 0:s.code)){const{cardBin:r,next_action:v,intent:m}=s;try{const t=await y({gatewayUrl:u,cardBin:r,intent:m,next_action:v,authFormContainer:i,componentType:e});"hpp"===e?(e=>{const t=new CustomEvent("on3dsSuccess",{detail:e,bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(t):((null==t?void 0:t.intent)&&(null==c||c.success(null==t?void 0:t.intent)),null===(l=null===(n=null==c?void 0:c.iframe)||void 0===n?void 0:n.contentWindow)||void 0===l||l.postMessage({code:"on3dsSuccess",confirmResult:t},u)),window.removeEventListener("message",o),window.removeEventListener("message",b),window.removeEventListener("message",E)}catch(t){"hpp"===e?(e=>{const t=new CustomEvent("on3dsError",{detail:{error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(t):(t&&(null==c||c.fail(t)),null===(a=null===(d=null==c?void 0:c.iframe)||void 0===d?void 0:d.contentWindow)||void 0===a||a.postMessage({code:"on3dsError",error:t},u)),window.removeEventListener("message",E)}}};window.addEventListener("message",o)},$={"01":["250px","400px"],"02":["390px","400px"],"03":["500px","600px"],"04":["600px","400px"],"05":["100%","100%"]};let x="";const I=({intent_id:e="",env:t="prod"})=>{if(!x.includes(e)){const n="prod"===t?"9ozphlqx":"45ssiuz3",i=document.createElement("script");x=`${e}${Date.now()}`,i.src=`https://h.online-metrix.net/fp/tags.js?org_id=${n}&session_id=${x}`,document.body.appendChild(i)}return x},U="card",A=e=>{const{payment_consent_id:t,id:n,customer_id:i,currency:o,latest_payment_attempt:l}=e,{payment_method:d}=l||{},{id:a,card:s}=d||{},{bin:r,last4:c,brand:u}=s||{};return{intent_id:n,payment_consent_id:t||"",customer_id:i||"",currency:o||"",payment_method:{id:a||"",bin:r,last4:c,brand:u}}};class S extends i{constructor(e,t){var n,i,o,l,d;super(e,t),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/card?options=${JSON.stringify({...this.options,fonts:null===(i=te.options)||void 0===i?void 0:i.fonts})}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex card element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex card element iframe"),this.addResizeListener(U),window.addEventListener("message",(e=>{var n,i,o,l,d,a,s,r,c,u,v,m,p,h,w,f,g,y,b,E,$,x,I,A,S,_;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.type)===U){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:U},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(l=this.domElement)||void 0===l||l.dispatchEvent(t)}if("onDynamicCurrencyConversion"===(null===(d=e.data)||void 0===d?void 0:d.code)){const t=new CustomEvent(null===(a=e.data)||void 0===a?void 0:a.code,{detail:{type:U},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(s=this.domElement)||void 0===s||s.dispatchEvent(t)}if("onReady"===(null===(r=e.data)||void 0===r?void 0:r.code)){const n=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:U},bubbles:!0,composed:!0});null===(u=this.domElement)||void 0===u||u.dispatchEvent(n),C({type:U,popupWidth:null===(v=null==t?void 0:t.style)||void 0===v?void 0:v.popupWidth,popupHeight:null===(m=null==t?void 0:t.style)||void 0===m?void 0:m.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer})}if("onSuccess"===(null===(p=e.data)||void 0===p?void 0:p.code)&&this.success(null===(h=e.data)||void 0===h?void 0:h.intent),"onError"===(null===(w=e.data)||void 0===w?void 0:w.code)&&this.fail(null===(f=e.data)||void 0===f?void 0:f.error),["onFocus","onBlur","onChange"].includes(null===(g=e.data)||void 0===g?void 0:g.code)){const t=new CustomEvent(null===(y=e.data)||void 0===y?void 0:y.code,{detail:{type:U,complete:null!==(E=null===(b=e.data)||void 0===b?void 0:b.complete)&&void 0!==E&&E,empty:null!==(x=null===($=e.data)||void 0===$?void 0:$.empty)&&void 0!==x&&x,error:null===(I=e.data)||void 0===I?void 0:I.error,brand:null!==(S=null===(A=e.data)||void 0===A?void 0:A.brand)&&void 0!==S?S:""},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(_=this.domElement)||void 0===_||_.dispatchEvent(t)}}}))}async confirm(e){var t,n,i;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:o,intent_id:l,element:d,...a}=e||{},s=I({intent_id:o,env:null===(t=null==te?void 0:te.options)||void 0===t?void 0:t.env});return null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"confirm",data:{...a,id:o||l,deviceId:s}},this.gatewayUrl),new Promise(((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0}))}async createPaymentConsent(e){var t,n,i;this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!");const{element:o,intent_id:l,...d}=e,a=I({intent_id:l,env:null===(t=null==te?void 0:te.options)||void 0===t?void 0:t.env});return null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"createPaymentConsent",data:{...d,deviceId:a,intent_id:l}},this.gatewayUrl),new Promise(((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0}))}success(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(A(e)),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1}fail(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}}}const _="cardNumber";class R extends i{constructor(e,t){var n,i,o,l,d;super(e,t),this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/card-number?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=te.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex card number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex card number element iframe"),this.addResizeListener(_),window.addEventListener("message",(e=>{var n,i,o,l,d,a,s,r,c,u,v,m,p,h,w,f,g,y,b,E,$,x,I,U,A,S,R,j,W,L,M,T,D,P,F;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.type)===_){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:_},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(l=this.domElement)||void 0===l||l.dispatchEvent(t)}if("onDynamicCurrencyConversion"===(null===(d=e.data)||void 0===d?void 0:d.code)){const t=new CustomEvent(null===(a=e.data)||void 0===a?void 0:a.code,{detail:{type:_},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(s=this.domElement)||void 0===s||s.dispatchEvent(t)}if("onReady"===(null===(r=e.data)||void 0===r?void 0:r.code)){const n=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:null===(u=e.data)||void 0===u?void 0:u.type},bubbles:!0,composed:!0});null===(v=this.domElement)||void 0===v||v.dispatchEvent(n),C({type:_,popupWidth:null===(m=null==t?void 0:t.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(p=null==t?void 0:t.style)||void 0===p?void 0:p.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer})}if("onSuccess"===(null===(h=e.data)||void 0===h?void 0:h.code)&&(this.confirmIntent.resolver||this.paymentConsent.resolver)&&this.success(null===(w=e.data)||void 0===w?void 0:w.intent),"onError"===(null===(f=e.data)||void 0===f?void 0:f.code)&&(this.confirmIntent.reject||this.paymentConsent.reject)&&this.fail(null===(g=e.data)||void 0===g?void 0:g.error),"onIntentRetrieved"===(null===(y=e.data)||void 0===y?void 0:y.code)&&this.retrieve.resolver&&this.success(null===(b=e.data)||void 0===b?void 0:b.intent),"onRetrieveIntentError"===(null===(E=e.data)||void 0===E?void 0:E.code)&&(this.fail(null===($=e.data)||void 0===$?void 0:$.error),this.retrieve.awaiting=!1),"onPaymentMethodCreated"===(null===(x=e.data)||void 0===x?void 0:x.code)&&this.createMethod.resolver&&(this.createMethod.resolver(null===(I=e.data)||void 0===I?void 0:I.paymentMethod),this.createMethod.awaiting=!1),"onPaymentMethodCreatedError"===(null===(U=e.data)||void 0===U?void 0:U.code)&&this.fail(null===(A=e.data)||void 0===A?void 0:A.error),["onFocus","onBlur","onChange"].includes(null===(S=e.data)||void 0===S?void 0:S.code)){const t=new CustomEvent(null===(R=e.data)||void 0===R?void 0:R.code,{detail:{type:_,complete:null!==(W=null===(j=e.data)||void 0===j?void 0:j.complete)&&void 0!==W&&W,empty:null!==(M=null===(L=e.data)||void 0===L?void 0:L.empty)&&void 0!==M&&M,error:null===(T=e.data)||void 0===T?void 0:T.error,brand:null!==(P=null===(D=e.data)||void 0===D?void 0:D.brand)&&void 0!==P?P:""},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(F=this.domElement)||void 0===F||F.dispatchEvent(t)}}}))}async confirm(e){var t,n,i;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:o,intent_id:l,element:d,...a}=e||{},s=I({intent_id:o,env:null===(t=null==te?void 0:te.options)||void 0===t?void 0:t.env});return null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"confirm",data:{...a,id:o||l,deviceId:s}},this.gatewayUrl),new Promise(((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0}))}async createPaymentMethod(e){var t,n;this.createMethod.awaiting&&console.warn("Should waiting previous createPaymentMethod finished before execute new one!");const{element:i,...o}=e||{};return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentMethod",data:o},this.gatewayUrl),new Promise(((e,t)=>{this.createMethod.resolver=e,this.createMethod.reject=t,this.createMethod.awaiting=!0}))}async createPaymentConsent(e){var t,n,i;this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!");const{element:o,intent_id:l,...d}=e,a=I({intent_id:l,env:null===(t=null==te?void 0:te.options)||void 0===t?void 0:t.env});return null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"createPaymentConsent",data:{...d,deviceId:a,intent_id:l}},this.gatewayUrl),new Promise(((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0}))}async getPaymentIntent(e,t){var n,i;return this.retrieve.awaiting&&console.warn("Should waiting previous getPaymentIntent finished before execute new one!"),null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"getIntent",data:{id:e,client_secret:t}},this.gatewayUrl),new Promise(((e,t)=>{this.retrieve.resolver=e,this.retrieve.reject=t,this.retrieve.awaiting=!0}))}success(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.retrieve.awaiting&&this.retrieve.resolver&&this.retrieve.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(A(e)),this.confirmIntent.awaiting=!1,this.retrieve.awaiting=!1,this.paymentConsent.awaiting=!1}fail(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.retrieve.awaiting&&this.retrieve.reject&&this.retrieve.reject(e),this.createMethod.awaiting&&this.createMethod.reject&&this.createMethod.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}}}const j="expiry";class W extends i{constructor(e,t){var n,i,o,l,d;super(e,t),null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/expiry?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=te.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex expiry number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex expiry number element iframe"),this.addResizeListener(j),window.addEventListener("message",(e=>{var t,n,i,o,l,d,a,s,r,c,u,v,m;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===j){if("onReady"===(null===(n=e.data)||void 0===n?void 0:n.code)){const t=new CustomEvent(null===(i=e.data)||void 0===i?void 0:i.code,{detail:{type:null===(o=e.data)||void 0===o?void 0:o.type},bubbles:!0,composed:!0});null===(l=this.domElement)||void 0===l||l.dispatchEvent(t)}if(["onFocus","onBlur","onChange"].includes(null===(d=e.data)||void 0===d?void 0:d.code)){const t=new CustomEvent(null===(a=e.data)||void 0===a?void 0:a.code,{detail:{type:j,complete:null!==(r=null===(s=e.data)||void 0===s?void 0:s.complete)&&void 0!==r&&r,empty:null!==(u=null===(c=e.data)||void 0===c?void 0:c.empty)&&void 0!==u&&u,error:null===(v=e.data)||void 0===v?void 0:v.error},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(m=this.domElement)||void 0===m||m.dispatchEvent(t)}}}))}}const L="cvc";class M extends i{constructor(e,t){var n,i,o,l,d;super(e,t),this.confirmIntent={resolver:null,reject:null,awaiting:!1},null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/cvc?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=te.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex cvc number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex cvc number element iframe"),this.addResizeListener("cvc"),window.addEventListener("message",(e=>{var n,i,o,l,d,a,s,r,c,u,v,m,p,h,w,f,g,y,b,E,$,x,I,U,A,S,_,R,j;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.type)===L){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:L},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(l=this.domElement)||void 0===l||l.dispatchEvent(t)}if("onDynamicCurrencyConversion"===(null===(d=e.data)||void 0===d?void 0:d.code)){const t=new CustomEvent(null===(a=e.data)||void 0===a?void 0:a.code,{detail:{type:L},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(s=this.domElement)||void 0===s||s.dispatchEvent(t)}if("onReady"===(null===(r=e.data)||void 0===r?void 0:r.code)){const n=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:null===(u=e.data)||void 0===u?void 0:u.type},bubbles:!0,composed:!0});null===(v=this.domElement)||void 0===v||v.dispatchEvent(n),C({type:L,popupWidth:null===(m=null==t?void 0:t.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(p=null==t?void 0:t.style)||void 0===p?void 0:p.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer})}if("onSuccess"===(null===(h=e.data)||void 0===h?void 0:h.code)&&this.confirmIntent.resolver&&this.success(null===(w=e.data)||void 0===w?void 0:w.intent),"onError"===(null===(f=e.data)||void 0===f?void 0:f.code)&&this.confirmIntent.reject&&this.fail(null===(g=e.data)||void 0===g?void 0:g.error),["onFocus","onBlur","onChange"].includes(null===(y=e.data)||void 0===y?void 0:y.code)){const t=new CustomEvent(null===(b=e.data)||void 0===b?void 0:b.code,{detail:{type:L,complete:null!==($=null===(E=e.data)||void 0===E?void 0:E.complete)&&void 0!==$&&$,empty:null!==(I=null===(x=e.data)||void 0===x?void 0:x.empty)&&void 0!==I&&I,error:null===(U=e.data)||void 0===U?void 0:U.error},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(A=this.domElement)||void 0===A||A.dispatchEvent(t)}}e.origin===this.gatewayUrl&&e.isTrusted&&"cardNumber"===(null===(S=e.data)||void 0===S?void 0:S.type)&&"onChange"===(null===(_=e.data)||void 0===_?void 0:_.code)&&(null===(j=null===(R=this.iframe)||void 0===R?void 0:R.contentWindow)||void 0===j||j.postMessage({code:"update",options:{cvcLength:e.data.cvcLength}},this.gatewayUrl))}))}async confirm(e){var t,n,i;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:o,intent_id:l,element:d,...a}=e||{},s=I({intent_id:o,env:null===(t=null==te?void 0:te.options)||void 0===t?void 0:t.env});return null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"confirm",data:{...a,id:o||l,deviceId:s}},this.gatewayUrl),new Promise(((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0}))}success(e){this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.confirmIntent.awaiting=!1}fail(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1}}}class T extends i{constructor(e,t){var n,i,o,l,d,a;super(e,t);const{intent:s}=t||{},r=I({intent_id:null==s?void 0:s.id,env:null===(n=null==te?void 0:te.options)||void 0===n?void 0:n.env});null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/elements/payment-request-button?options=${encodeURIComponent(JSON.stringify({...t,deviceId:r,fonts:null===(o=te.options)||void 0===o?void 0:o.fonts}))}&lang=${null===(l=te.options)||void 0===l?void 0:l.locale}`),null===(d=this.iframe)||void 0===d||d.setAttribute("name","Airwallex payment request element iframe"),null===(a=this.iframe)||void 0===a||a.setAttribute("title","Airwallex payment request element iframe"),this.addResizeListener("paymentRequestButton"),window.addEventListener("message",(e=>{var n,i,o,l,d,a,s,r,c,u,v;if(e.origin===this.gatewayUrl&&e.isTrusted&&"paymentRequestButton"===(null===(n=e.data)||void 0===n?void 0:n.type))if("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)){C({type:"paymentRequestButton",popupWidth:null===(o=null==t?void 0:t.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==t?void 0:t.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer});const n=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:null===(a=e.data)||void 0===a?void 0:a.type},bubbles:!0,composed:!0});null===(s=this.domElement)||void 0===s||s.dispatchEvent(n)}else"onSuccess"===(null===(r=e.data)||void 0===r?void 0:r.code)?this.success(null===(c=e.data)||void 0===c?void 0:c.intent):"onError"===(null===(u=e.data)||void 0===u?void 0:u.code)&&this.fail(null===(v=e.data)||void 0===v?void 0:v.error)}))}success(e){const t=new CustomEvent("onSuccess",{detail:{type:"paymentRequestButton",intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}fail(e){const t=new CustomEvent("onError",{detail:{type:"paymentRequestButton",error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}const D="dropIn";class P extends i{constructor(e,t){var n,i,o,l,d,a;super(e,t);const{intent_id:s}=t||{},r=I({intent_id:s,env:null===(n=null==te?void 0:te.options)||void 0===n?void 0:n.env});null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/elements/dropin?options=${encodeURIComponent(JSON.stringify({...t,deviceId:r,fonts:null===(o=te.options)||void 0===o?void 0:o.fonts}))}&lang=${null===(l=te.options)||void 0===l?void 0:l.locale}`),null===(d=this.iframe)||void 0===d||d.setAttribute("name","Airwallex dropIn element iframe"),null===(a=this.iframe)||void 0===a||a.setAttribute("title","Airwallex dropIn element iframe"),this.addResizeListener(D),window.addEventListener("message",(e=>{var n,i,o,l,d,a,s,r,c,u,v,m,p;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(n=e.data)||void 0===n?void 0:n.type)===D){if("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)){C({type:D,popupWidth:null===(o=null==t?void 0:t.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==t?void 0:t.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer});const n=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:D},bubbles:!0,composed:!0});null===(a=this.domElement)||void 0===a||a.dispatchEvent(n)}if("onRedirect"===(null===(s=e.data)||void 0===s?void 0:s.code)){const{redirectUrl:t}=null!==(c=null===(r=e.data)||void 0===r?void 0:r.redirectPayload)&&void 0!==c?c:{};window.location.href=t}else"onSuccess"===(null===(u=e.data)||void 0===u?void 0:u.code)?this.success(null===(v=e.data)||void 0===v?void 0:v.intent):"onError"===(null===(m=e.data)||void 0===m?void 0:m.code)&&this.fail(null===(p=e.data)||void 0===p?void 0:p.error)}}))}success(e){var t;const n=new CustomEvent("onSuccess",{detail:{type:D,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:D,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}}const F="fullFeaturedCard";class z extends i{constructor(e,t){var n,i,o,l,d,a;super(e,t);const{intent:s}=t||{},r=I({intent_id:null==s?void 0:s.id,env:null===(n=null==te?void 0:te.options)||void 0===n?void 0:n.env});null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/elements/full-featured-card?options=${encodeURIComponent(JSON.stringify({...t,deviceId:r,fonts:null===(o=te.options)||void 0===o?void 0:o.fonts}))}&lang=${null===(l=te.options)||void 0===l?void 0:l.locale}`),null===(d=this.iframe)||void 0===d||d.setAttribute("name","Airwallex full featured card element iframe"),null===(a=this.iframe)||void 0===a||a.setAttribute("title","Airwallex full featured card element iframe"),this.addResizeListener(F),window.addEventListener("message",(e=>{var n,i,o,l,d,a,s,r,c,u,v;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(n=e.data)||void 0===n?void 0:n.type)===F)if("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)){C({type:F,popupWidth:null===(o=null==t?void 0:t.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==t?void 0:t.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer});const n=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:null===(a=e.data)||void 0===a?void 0:a.type},bubbles:!0,composed:!0});null===(s=this.domElement)||void 0===s||s.dispatchEvent(n)}else"onSuccess"===(null===(r=e.data)||void 0===r?void 0:r.code)?this.success(null===(c=e.data)||void 0===c?void 0:c.intent):"onError"===(null===(u=e.data)||void 0===u?void 0:u.code)&&this.fail(null===(v=e.data)||void 0===v?void 0:v.error)}))}update(e){var t,n,i;this.options={...this.options,...e};const{intent:o}=this.options||{},l=I({intent_id:null==o?void 0:o.id,env:null===(t=null==te?void 0:te.options)||void 0===t?void 0:t.env});null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"update",options:{...e,deviceId:l}},this.gatewayUrl)}success(e){var t;const n=new CustomEvent("onSuccess",{detail:{type:F,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:F,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}}const N="wechat";class q extends i{constructor(e,t){var n,i,o,l,d;super(e,t),null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/wechat?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=te.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex wechat element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex wechat element iframe"),this.addResizeListener(N),window.addEventListener("message",(e=>{var t,n,i,o,l,d;e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===N&&("onRedirect"===(null===(n=e.data)||void 0===n?void 0:n.code)?window.location.href=null===(i=e.data)||void 0===i?void 0:i.redirectUrl:"onSuccess"===(null===(o=e.data)||void 0===o?void 0:o.code)?this.success(null===(l=e.data)||void 0===l?void 0:l.intent):"onError"===(null===(d=e.data)||void 0===d?void 0:d.code)&&this.fail(e.data.error))}))}success(e){var t;const n=new CustomEvent("onSuccess",{detail:{type:N,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:N,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}}const B="qrcode";class H extends i{constructor(e,t){var n,i,o,l,d;super(e,t),null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/qrcode?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=te.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex qrcode element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex qrcode element iframe"),this.addResizeListener(B),window.addEventListener("message",(e=>{var t,n,i,o;e.origin===this.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===B&&("onSuccess"===(null===(n=e.data)||void 0===n?void 0:n.code)?this.success(null===(i=e.data)||void 0===i?void 0:i.intent):"onError"===(null===(o=e.data)||void 0===o?void 0:o.code)&&this.fail(e.data.error))}))}success(e){var t;const n=new CustomEvent("onSuccess",{detail:{type:B,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:B,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)}}class O extends i{constructor(e,t){var n,i,o,l,d;super(e,t),null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/redirect?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=te.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=te.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex redirect element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex redirect element iframe"),this.addResizeListener("redirect"),window.addEventListener("message",(e=>{var n,i,o,l,d;if(e.origin===this.gatewayUrl&&e.isTrusted&&"redirect"===(null===(n=e.data)||void 0===n?void 0:n.type))if("onRedirect"===(null===(i=e.data)||void 0===i?void 0:i.code)){const{redirectUrl:n,method:i}=null!==(l=null===(o=e.data)||void 0===o?void 0:o.redirectPayload)&&void 0!==l?l:{};i===(null==t?void 0:t.method)&&(window.location.href=n)}else"onError"===(null===(d=e.data)||void 0===d?void 0:d.code)&&this.fail(e.data.error)}))}fail(e){var t;const n=new CustomEvent("onError",{detail:{type:"redirect",error:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),window.document.dispatchEvent(n)}}const k=e=>e.startsWith("http://")||e.startsWith("https://")?encodeURIComponent(e):encodeURIComponent(`https://${e}`),J=/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/,V=e=>"string"==typeof e,Z=e=>"boolean"==typeof e,G=e=>"string"==typeof e&&J.test(e),K=e=>"object"==typeof e&&null!==e,Q={intent_id:{validate:V,format:e=>`${e}`},client_secret:{validate:V,format:e=>`${e}`},theme:{validate:K,format:e=>JSON.stringify(e)},customer_id:{validate:V,format:e=>`${e}`},components:{validate:K,format:e=>JSON.stringify(e)},autoCapture:{validate:Z,format:e=>`${e}`},successUrl:{validate:G,format:e=>k(`${e}`)},failUrl:{validate:G,format:e=>k(`${e}`)},cancelUrl:{validate:G,format:e=>k(`${e}`)},logoUrl:{validate:G,format:e=>k(`${e}`)},locale:{validate:V,format:e=>`${e}`},withBilling:{validate:Z,format:e=>`${e}`},mode:{validate:V,format:e=>`${e}`},recurringOptions:{validate:K,format:e=>encodeURIComponent(JSON.stringify(e))},currency:{validate:V,format:e=>`${e}`},country_code:{validate:V,format:e=>`${e}`},shopper_name:{validate:V,format:e=>`${e}`},shopper_phone:{validate:V,format:e=>`${e}`},shopper_email:{validate:V,format:e=>`${e}`}},X=e=>`https://${t[e]||"checkout.airwallex.com"}`,Y=["cardNumber","expiry","cvc","paymentRequestButton","card","wechat","qrcode","redirect","dropIn","fullFeaturedCard"],ee=[...Y,"threeDsFrictionless","threeDsChallenge"],te={gatewayUrl:"",options:{}},ne={cardNumber:null,expiry:null,cvc:null,threeDsFrictionless:null,threeDsChallenge:null,paymentRequestButton:null,card:null,wechat:null,qrcode:null,redirect:null,dropIn:null,fullFeaturedCard:null},ie=e=>{var t;return ee.includes(e)?(null===(t=ne[e])||void 0===t||t.destroy(),ne[e]=null,!0):(console.warn(`destroyElement with type: ${e} not support!`),!1)},oe=e=>ee.includes(e)?ne[e]:(console.warn(`getElement with type: ${e} not support!`),null),le=(e,t)=>ee.includes(e)?(ne[e]=t,!0):(console.warn(`destroyElement with type: ${e} not support!`),!1);return e.confirmPaymentIntent=async e=>(console.info(`Confirm intent ${(null==e?void 0:e.intent_id)||(null==e?void 0:e.id)} with client secret: ${null==e?void 0:e.client_secret}`),(null==e?void 0:e.element)?(null==e?void 0:e.element).confirm(e):(console.warn("Card number element must be provided for card payment confirm!"),!1)),e.confirmPaymentIntentWithSavedCard=async e=>(console.info(`Confirm intent ${(null==e?void 0:e.intent_id)||(null==e?void 0:e.id)} with client secret: ${null==e?void 0:e.client_secret}`),(null==e?void 0:e.element)&&(null==e?void 0:e.methodId)?(null==e?void 0:e.element).confirm(e):(console.warn("Payment method id must be provided for cvc payment confirm!"),!1)),e.createElement=(e,t)=>{var n;const i=null!=t?t:{origin:""};return i.origin||(i.origin=null===(n=te.options)||void 0===n?void 0:n.origin),Y.includes(e)?"cardNumber"===e?(ne[e]=new R(te.gatewayUrl,i),ne[e]):"card"===e?(ne[e]=new S(te.gatewayUrl,i),ne[e]):"fullFeaturedCard"===e?(ne[e]=new z(te.gatewayUrl,i),ne[e]):"wechat"===e?(ne[e]=new q(te.gatewayUrl,i),ne[e]):"qrcode"===e?(ne[e]=new H(te.gatewayUrl,i),ne[e]):"redirect"===e?(ne[e]=new O(te.gatewayUrl,i),ne[e]):"paymentRequestButton"===e?(ne[e]=new T(te.gatewayUrl,i),ne[e]):"dropIn"===e?(ne[e]=new P(te.gatewayUrl,i),ne[e]):"expiry"===e||"cvc"===e?(ne[e]="expiry"===e?new W(te.gatewayUrl,i):new M(te.gatewayUrl,i),window.addEventListener("message",(t=>{var n,i,o,l,d,a;t.origin===te.gatewayUrl&&t.isTrusted&&e===(null===(n=t.data)||void 0===n?void 0:n.type)&&"onChange"===(null===(i=t.data)||void 0===i?void 0:i.code)&&(null===(d=null===(l=null===(o=ne.cardNumber)||void 0===o?void 0:o.iframe)||void 0===l?void 0:l.contentWindow)||void 0===d||d.postMessage({code:`update_${null===(a=t.data)||void 0===a?void 0:a.type}`,data:t.data},te.gatewayUrl))})),ne[e]):null:(console.warn(`createElement with type: ${e} not support!`),null)},e.createPaymentConsent=async e=>(console.info(`Create payment consent with client secret: ${e.client_secret}`),(null==e?void 0:e.element)?(null==e?void 0:e.element).createPaymentConsent(e):(console.warn("Either payment method id or element must be provided for create payment consent!"),!1)),e.createPaymentMethod=async(e,t)=>(console.info(`Create payment method with client secret: ${e}`),(null==t?void 0:t.element)?(null==t?void 0:t.element).createPaymentMethod({...t,client_secret:e}):(console.warn("Either payment method id or element must be provided for payment method create!"),!1)),e.destroyElement=ie,e.get3dsReturnUrl=e=>{const{env:i,checkoutOrigin:o}=e;return`${n[i||"prod"]}/api/v1/checkout/elements/3ds?origin=https://${t[i||"prod"]}&checkoutOrigin=${o||window.location.origin}`},e.getBrowserInfo=e=>{const{navigator:t,screen:n}=window||{},{language:i}=t||{},{colorDepth:o,height:l,width:d}=n||{},{intent_id:a,env:s}=e||{};let r;return e&&(r=I({intent_id:a,env:s})),{device_id:r,screen_height:l,screen_width:d,screen_color_depth:o,language:i,timezone:(new Date).getTimezoneOffset(),browser:{java_enabled:window.navigator.javaEnabled(),javascript_enabled:!0,user_agent:t.userAgent}}},e.getDeviceFingerprint=I,e.getElement=oe,e.getPaymentIntent=async(e,t)=>{var n;return(null===(n=ne.cardNumber)||void 0===n?void 0:n.getPaymentIntent(e,t))||!1},e.handle3ds=e=>{const{cardBin:n,next_action:i,authFormContainer:o,intent:l,challengeWindowSize:d,env:a}=e;return y({gatewayUrl:`https://${t[a]}`,cardBin:n,intent:l,next_action:i,authFormContainer:o,componentType:"api",challengeWindowSize:d})},e.handle3dsFlow=C,e.init=e=>{!(null==e?void 0:e.env)&&te.gatewayUrl||(te.gatewayUrl=X((null==e?void 0:e.env)||"prod")),te.options=e},e.redirectToCheckout=e=>{const{env:t,...n}=e,i=(e=>{const t={};return Object.keys(Q).forEach((n=>{const i=e[n];i&&Q[n].validate(i)&&(t[n]=Q[n].format(i))})),t})(n),{id:o,...l}=i||{},d=Object.keys(l),a=[];d.forEach((e=>{a.push(`${e}=${l[e]}`)}));const s="recurring"===e.mode?`${X(t||"prod")}/#/standalone/recurring?${a.join("&")}&from=${window.location.origin}`:`${X(t||"prod")}/#/standalone/checkout/${o||(null==l?void 0:l.intent_id)}?${a.join("&")}&from=${window.location.origin}`;window.location.href=s},Object.defineProperty(e,"__esModule",{value:!0}),e}({});